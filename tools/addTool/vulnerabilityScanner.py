import requests
import re
import os
from urllib.parse import urljoin

common_vulnerabilities = [
    "admin.php", "login.php", "config.php", "index.php", "dashboard.php",
    "user.php", "register.php", "forgot_password.php", "reset.php",
    "upload.php", "file_manager.php", "backup.php", "db_admin.php",
    "admin/login.php", "admin/dashboard.php", "cpanel.php",
    ".env", "wp-admin", "wp-login.php", "phpinfo.php",
    ".git/config", ".htaccess", ".htpasswd", "setup.php", "install.php"
]

def main():
    target_url = input("Enter the target URL (https or http required, e.g., ): ").strip()

    url_pattern = re.compile(r'^(http://|https://)([a-zA-Z0-9.-]+)(:[0-9]+)?(/.*)?$')
    if not url_pattern.match(target_url):
        print("[-] Invalid URL. Please include 'http://' or 'https://' and a valid domain.")
        return

    results = []

    def vulnerability_scanner(target_url):
        print(f"[*] Scanning {target_url} for vulnerabilities...")
        for vuln in common_vulnerabilities:
            url = urljoin(target_url.rstrip('/'), vuln)
            try:
                response = requests.get(url, timeout=5)
                if response.status_code == 200:
                    result = f"[+] Found: {url}"
                    results.append(result)
                    print(result)
                elif response.status_code == 403:
                    result = f"[!] Forbidden: {url}"
                    results.append(result)
                    print(result)
                else:
                    result = f"[-] Not Found: {url}"
                    results.append(result)
                    print(result)
            except requests.exceptions.RequestException as e:
                result = f"[-] Error scanning {url}: {e}"
                results.append(result)
                print(result)
    
    vulnerability_scanner(target_url)

    save_results = input("Do you want to save the results? (Y/N): ").strip().lower()
    if save_results == 'y':
        os.makedirs('vulnerabilityScanner', exist_ok=True)
        with open('vulnerabilityScanner/results.txt', 'w') as file:
            for line in results:
                file.write(line + "\n")
        print("[+] Results saved in 'vulnerabilityScanner/results.txt'")
    else:
        print("[-] Results not saved.")

if __name__ == "__main__":
    main()